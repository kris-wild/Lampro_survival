
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>iso_21_var</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-03-22"><meta name="DC.source" content="iso_21_var.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><h1>iso_21_var</h1><!--introduction--><p>computes age and length at birth, intitial reserve of the iso_21 model</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#3">Syntax</a></li><li><a href="#4">Description</a></li><li><a href="#5">Remarks</a></li></ul></div><h2>Syntax<a name="3"></a></h2><p>[L_b a_b M_E10 M_E20 info] = <a href="../iso_21_var.m"><b>iso_21_var</b></a> (m_E1b, m_E2b, p)</p><h2>Description<a name="4"></a></h2><p>computes age and length at birth, intitial reserve of the iso_21 model</p><p>Input:</p><div><ul><li>m_E1b: scalar with reserve density 1 at birth (mol/mol)</li><li>m_E2b: scalar with reserve density 2 at birth (mol/mol)</li><li>p: 14-vector with parameters: v, kap, mu_E1, mu_E2, mu_V, j_E1M, MV, k_J, kap_G, kap_E1, kap+E2, E_Hb</li></ul></div><p>Output:</p><div><ul><li>L_b: scalar with length at birth (cm)</li><li>a_b: scalar with age at birth (d)</li><li>M_E10: scalar with initial reserve 1 (mol)</li><li>M_E20: scalar with initial reserve 2 (mol)</li><li>info: indicator for failure (0) or success (1)</li></ul></div><h2>Remarks<a name="5"></a></h2><p>requires fniso_21_var, diso_21_var (see below)</p><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
##### SOURCE BEGIN #####
%% iso_21_var
% computes age and length at birth, intitial reserve of the iso_21 model

%%
function [L_b a_b M_E10 M_E20 info] = iso_21_var(m_E1b, m_E2b, p)
  % created 2012/03/06 by Bas Kooijman

  %% Syntax
  % [L_b a_b M_E10 M_E20 info] = <../iso_21_var.m *iso_21_var*> (m_E1b, m_E2b, p)

  %% Description
  % computes age and length at birth, intitial reserve of the iso_21 model
  %
  % Input:
  %
  % * m_E1b: scalar with reserve density 1 at birth (mol/mol)
  % * m_E2b: scalar with reserve density 2 at birth (mol/mol)
  % * p: 14-vector with parameters: v, kap, mu_E1, mu_E2, mu_V, j_E1M, MV, k_J, kap_G, kap_E1, kap+E2, E_Hb
  %
  % Output:
  %
  % * L_b: scalar with length at birth (cm)
  % * a_b: scalar with age at birth (d)
  % * M_E10: scalar with initial reserve 1 (mol)
  % * M_E20: scalar with initial reserve 2 (mol)
  % * info: indicator for failure (0) or success (1)
  
  %% Remarks
  % requires fniso_21_var, diso_21_var (see below)

  % unpack some parameters, see diso_21_var for a full list
  v         = p(1);  % cm/d, energy conductance
  kap       = p(2);  % -, allocation fraction to soma
  mu_E1     = p(3);  % J/mol, chemical potential of reserve 1
  mu_E2     = p(4);  % J/mol, chemical potential of reserve 2
  mu_V      = p(5);  % J/mol, chemical potenial of structure
  j_E1M     = p(6);  % mol/d.mol, specific som maint costs
  MV        = p(7);  % mol/cm^3, [M_V] density of structure                
  %k_J       = p(8);  % 1/d, mat maint rate coeff                                
  kap_G     = p(9);  % -, preference for reserve 1 to be used for som maint
  %kap_E1    = p(10); % -, fraction of rejected mobilised flux that is returned to reserve
  %kap_E2    = p(11); % -, fraction of rejected mobilised flux that is returned to reserve
  E_Hb      = p(12);% J, maturity threshold at birth

  % initial guess for M_E0 given m_Eb
  E_G = MV * mu_V/ kap_G;            % J/cm^3, [E_G] spec cost for structure
  V_b = E_Hb * kap/ E_G/ (1 - kap);  % cm^3, initial guess for length at birth
  M_Vb = MV * V_b;                   % mol, initial guess for structural mass at birth
  M_E1b = M_Vb * m_E1b; M_E2b = M_Vb * m_E2b; % mol, initial guess for reserve mass at birth
  L_b = V_b^(1/3);                   % cm. initial guess for langth at birth
  mu_E1V = mu_E1/ mu_V; mu_E2V = mu_E2/ mu_V; % -, ratios of mu's
  M_E1G = MV * V_b/ mu_E1V; M_E2G = (1/ kap_G - 1) * MV * V_b/ mu_E2V; % mol, cost for structure at birth
  M_E10 = M_E1b + M_E1G/ kap;        % mol, initial guess for initial reserve 1
  J_E2Mb = M_Vb * j_E1M * mu_E1/ mu_E2; % mol/d, som maint for 2 at birth
  M_E2M = 0.75 * J_E2Mb * L_b/ v;     % mol, initial guess for initial reserve 2
  M_E20 = M_E2b + (M_E2M + M_E2G)/ kap; % mol, initial guess for initial reserve 2

  % solve initial amounts of reserves
  [M_E0 fn info] = fsolve(@fniso_21_var, [M_E10; M_E20], [], m_E1b, m_E2b, p);
  info
  M_E10 = M_E0(1); M_E20 = M_E0(2);

  % get L_b and a_b
  [F L_b a_b] = fniso_21_var(M_E0, m_E1b, m_E2b, p);

% subfunction fniso_21_var

function [F L_b a_b] = fniso_21_var(M_E0, m_E1b, m_E2b, p)
% for use by fsolve in iso_21: F = 0 if M_E0 are such that m_Eb are specified values

% unpack variables
M_E10 = M_E0(1); M_E20 = M_E0(2);    % mol, initial reserve

% unpack some parameters, see diso_21_var for a full list
v         = p(1);  % cm/d, energy conductance
kap       = p(2);  % -, allocation fraction to soma
mu_E1     = p(3);  % J/mol, chemical potential of reserve 1
mu_E2     = p(4);  % J/mol, chemical potential of reserve 2
mu_V      = p(5);  % J/mol, chemical potenial of structure
%j_E1M     = p(6);  % mol/d.mol, specific som maint costs
MV        = p(7);  % mol/cm^3, [M_V] density of structure                
%k_J       = p(8);  % 1/d, mat maint rate coeff                                
kap_G     = p(9);  % -, preference for reserve 1 to be used for som maint
%kap_E1    = p(10); % -, fraction of rejected mobilised flux that is returned to reserve
%kap_E2    = p(11); % -, fraction of rejected mobilised flux that is returned to reserve
E_Hb     = p(12);% J, maturity threshold at birth

% conditions for small age a_0 as fraction of guess value for a_b at which 
%   maintenance is not yet important and m_E0 not very large any longer
mu_E1V = mu_E1/ mu_V; mu_E2V = mu_E1/mu_V; % mol/mol
E_G = MV * mu_V/ kap_G;              % J/cm^3, [E_G] spec cost for structure
V_b = E_Hb * kap/ E_G/ (1 - kap);    % cm, initial guess for length at birth
a_b = V_b^(1/3) * 3/ v;              % d, initial guess for age at birth
a_0 = a_b/ 100;                      % d, initial age from where integration starts
L_0 = a_0 * v/ 3;                    % cm, initial structural length
M_V0 = MV * L_0^3;                   % mol, initial structural mass
y_VE1 = mu_E1V; y_VE2 = mu_E2V * kap_G/ (1 - kap_G); % mol/mol, yield coefficients
E_H0 = M_V0 * (mu_E1/ y_VE1 + mu_E2/ y_VE2) * (1 - kap)/ kap;  % J, initial maturity
m_E10 = M_E10/ M_V0 - 1/ kap/ y_VE1; % mol/mol, initial reserve density 1
m_E20 = M_E20/ M_V0 - 1/ kap/ y_VE2; % mol/mol, initial reserve density 2

[E_H LEa] = ode45(@diso_21_var,[E_H0; E_Hb], [L_0; m_E10; m_E20; a_0], [], p);
F = [m_E1b; m_E2b] - LEa(end,[2 3])'; % mol/mol, norm function set to zero

L_b = LEa(end,1); % cm, length at birth
a_b = LEa(end,4); % d, age at birth

% subfunction diso_21_var

function dLEa = diso_21_var(E_H, LEa, p)
% ode's for iso_21:
%   derivatives of (L, m_E1, m_E2, a) with respect to E_H during embryo stage, used by iso_21

% unpack parameters
v         = p(1);  % cm/d, energy conductance
kap       = p(2);  % -, allocation fraction to soma
mu_E1     = p(3);  % J/mol, chemical potential of reserve 1
mu_E2     = p(4);  % J/mol, chemical potential of reserve 2
mu_V      = p(5);  % J/mol, chemical potenial of structure
j_E1M     = p(6);  % mol/d.mol, specific som maint costs
MV        = p(7);  % mol/cm^3, [M_V] density of structure                
k_J       = p(8);  % 1/d, mat maint rate coeff                                
kap_G     = p(9);  % -, preference for reserve 1 to be used for som maint
kap_E1    = p(10); % -, fraction of rejected mobilised flux that is returned to reserve
kap_E2    = p(11); % -, fraction of rejected mobilised flux that is returned to reserve
%E_Hb     = p(12);% J, maturity threshold at birth

% unpack states
L = LEa(1);                                                   % cm, structural length
m_E1 = LEa(2);                                                % mol/mol, reserve density 1
m_E2 = LEa(3);                                                % mol/mol, reserve density 2
%a = LEa(4);                                                  % d, age
M_V = MV * L^3;                                               % mol, structural mass 

%growth
j_E2M = j_E1M * mu_E1/ mu_E2;                                 % mol/d.mol, spec som maint for 2
[r, j_E1_M, j_E2_M, j_E1C, j_E2C, j_E1P, j_E2P] = ...                      % cm/d, change in L, ..
    sgr_iso_21_var (m_E1, m_E2, j_E1M, j_E2M, mu_E1, mu_E2, mu_V, v/L, kap_G, kap);
J_E1C = j_E1C * M_V; J_E2C = j_E2C * M_V; % mol/d, mobilisation flux
dL = r * L/ 3; 

% maturation
p_C = mu_E1 * J_E1C + mu_E2 * J_E2C;                          % J/d, total mobilisation
dE_H = (1 - kap) * p_C - k_J * E_H;                           % J/d, maturation

% reserve dynamics
dm_E1 = kap_E1 * j_E1P - m_E1 * v/ L;                         % mol/d.mol, change in m_E1
dm_E2 = kap_E2 * j_E2P - m_E2 * v/ L;                         % mol/d.mol, change in m_E2

dLEa = [dL; dm_E1; dm_E2; 1]/ dE_H;                           % pack output

##### SOURCE END #####
--></body></html>