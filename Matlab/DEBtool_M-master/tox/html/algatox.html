
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>algatox</title><meta name="generator" content="MATLAB 9.10"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2022-03-28"><meta name="DC.source" content="algatox.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>algatox</h1><!--introduction--><p>effects on alga growth</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#3">Syntax</a></li><li><a href="#4">Description</a></li><li><a href="#5">Remarks</a></li><li><a href="#6">Example of use</a></li></ul></div><h2 id="3">Syntax</h2><p>f = <a href="../algatox.m"><b>algatox</b></a>(p, t, c)</p><h2 id="4">Description</h2><p>effects on alga growth:   (1) partial killing of inoculum   (2) killing during growth   (3) increase of costs for growth   instantaneous equilibrium of internal concentration   growth is assumed to be nutrient limited     the nutrient pool is exchanging with a pool that is not available     to the algae   algal mass is measured in Optical Densities. The contribution     of living, dead and ghost might differ. The toxic compound can     tranfer living into dead biomass, the dead biomass decays to     ghost biomass according to a first order process.   the no-effect-conc for the three effects are taken to be the same     might actually be different, however!</p><p>Input:</p><div><ul><li>p: (17,k) matrix with parameters values in p(:,1) (see below)</li></ul></div><pre>   01 mM, background nutrient
   02 mM, initial nutrient conc
   03 mM, initial biomass
   04 OD/mM, weight of living in optical density (redundant par)
   05 OD/mM, weight of dead in optical density
   06 OD/mM, weight of ghosts in optical density
   07 bmM, half saturation constant for nutrient
   08 mM/mM, yield of reserves on structure
   09 mM/(mM*h), max spec nutrient uptake rate
   10 1/h, reserve turnover rate
   11 1/h, exchange from nutrient to background
   12 1/h, exchange from background to nutrient
   13 1/h, dead biomass decay rate to ghost
   14 mM, no-effect concentration
   15 mM, tolerance conc for initial mortality
   16 mM, tolerance concentration for costs of growth
   17 1/(mM*h), spec killing rate</pre><div><ul><li>t: (tn,1) matrix with exposure times</li><li>c: (cn,1) matrix with concentrations of toxic compound</li></ul></div><p>Output</p><div><ul><li>f: (nt,nc) matrix with Optical Densities</li></ul></div><h2 id="5">Remarks</h2><p>uses routine dalgatox for integration  Instantaneous equilibrium is assumed for the internal concentration.  Growth is assumed to be nutrient limited, and the nutrient pool is exchanging with a pool that is not available to the algae.  Algal mass is measured in Optical Densities. The contribution of living biomass, dead biomass and ghost biomass might differ.  The toxic compound can tranfer living into dead biomass, the dead biomass decays to ghost biomass according to a first order process.  The no-effect-conc for the three effects are taken to be the same, but they might actually be different, however!</p><h2 id="6">Example of use</h2><p>see <a href="../mydata_algatox.m"><b>mydata_algatox</b></a></p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2021a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% algatox
% effects on alga growth

%%
function f = algatox(p, t, c)
  %  created 2002/02/05 by Bas Kooijman
  
  %% Syntax
  % f = <../algatox.m *algatox*>(p, t, c)
  
  %% Description
  % effects on alga growth:
  %   (1) partial killing of inoculum
  %   (2) killing during growth
  %   (3) increase of costs for growth
  %   instantaneous equilibrium of internal concentration
  %   growth is assumed to be nutrient limited
  %     the nutrient pool is exchanging with a pool that is not available
  %     to the algae
  %   algal mass is measured in Optical Densities. The contribution
  %     of living, dead and ghost might differ. The toxic compound can
  %     tranfer living into dead biomass, the dead biomass decays to
  %     ghost biomass according to a first order process.
  %   the no-effect-conc for the three effects are taken to be the same
  %     might actually be different, however! 
  %
  % Input:
  %
  % *  p: (17,k) matrix with parameters values in p(:,1) (see below)
  %
  %     01 mM, background nutrient
  %     02 mM, initial nutrient conc
  %     03 mM, initial biomass
  %     04 OD/mM, weight of living in optical density (redundant par)
  %     05 OD/mM, weight of dead in optical density
  %     06 OD/mM, weight of ghosts in optical density
  %     07 bmM, half saturation constant for nutrient
  %     08 mM/mM, yield of reserves on structure
  %     09 mM/(mM*h), max spec nutrient uptake rate
  %     10 1/h, reserve turnover rate
  %     11 1/h, exchange from nutrient to background
  %     12 1/h, exchange from background to nutrient
  %     13 1/h, dead biomass decay rate to ghost
  %     14 mM, no-effect concentration
  %     15 mM, tolerance conc for initial mortality
  %     16 mM, tolerance concentration for costs of growth
  %     17 1/(mM*h), spec killing rate
  %
  % * t: (tn,1) matrix with exposure times
  % * c: (cn,1) matrix with concentrations of toxic compound
  %
  % Output
  %
  % * f: (nt,nc) matrix with Optical Densities
  
  %% Remarks
  % uses routine dalgatox for integration
  %  Instantaneous equilibrium is assumed for the internal concentration.
  %  Growth is assumed to be nutrient limited, and the nutrient pool is exchanging with a pool that is not available to the algae. 
  %  Algal mass is measured in Optical Densities. The contribution of living biomass, dead biomass and ghost biomass might differ. 
  %  The toxic compound can tranfer living into dead biomass, the dead biomass decays to ghost biomass according to a first order process. 
  %  The no-effect-conc for the three effects are taken to be the same, but they might actually be different, however! 
  
  %% Example of use
  % see <../mydata_algatox.m *mydata_algatox*>
 

  global K yEV kN kE k0 kNB kBN c0 cH cy b ci;

  % unpack parameter vector
  B0 = p(1);  % mM. background nutrient
  N0 = p(2);  % mM, initial nutrient conc
  X0 = p(3);  % mM, initial biomass
  w =  p(4);  % OD/mM, weight of living in optical density (redundant par)
  wd = p(5);  % OD/mM, weight of dead in optical density
  w0 = p(6);  % OD/mM, weight of ghosts in optical density
  K = p(7);   % mM, half saturation constant for nutrient
  yEV = p(8); % mM/mM, yield of reserves on structure
  kN = p(9);  % mM/(mM*h), max spec nutrient uptake rate
  kE = p(10); % 1/h, reserve turnover rate
  kNB = p(11);% 1/h, exchange from nutrient to background
  kBN = p(12);% 1/h, exchange from background to nutrient
  k0 = p(13); % 1/h, dead biomass decay rate to ghost
  c0 = p(14); % mM, no-effect concentration
  cH = p(15); % mM, tolerance conc for initial mortality
  cy = p(16); % mM, tolerance concentration for costs of growth
  b = p(17);  % 1/(mM*h), spec killing rate

  nt = max(size(t)); nc = max(size(c)); f = zeros (nt, nc);

  m0 = kN/ kE; % initial reserve density
  for i = 1:nc % loop across concentrations
    ci = c(i); % current concentration
    F = exp(-max(0,(c(i)-c0)/ cH)); % initial survival prob
    % initial state vector background, nutrient, reserve, living, dead, ghost
    Y0 = [B0, N0, m0, X0*F, X0*(1-F), 0]';
    [t Y] = ode23s('dalgatox', t, Y0); % integrate
    % unpack state vector
    X = Y(:,4); Xd = Y(:,5); Xg = Y(:,6); % living, dead, ghost
    f(:,i) = w*X + wd*Xd + w0*Xg; % optical density
  end

##### SOURCE END #####
--></body></html>